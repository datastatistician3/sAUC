<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Semi-parametric Area Under the Curve (AUC) regression • sAUC</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">sAUC</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/sAUC.html">Example</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/bohora-etal-sauc-paper.pdf">Paper in the Journal of Data Science</a>
    </li>
  </ul>
</li>
<li>
  <a href="reference/index.html">Shiny Application</a>
</li>
<li>
  <a href="articles/example-python.html">sAUC in Python</a>
</li>
<li>
  <a href="articles/example-julia.html">sAUC in Julia</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sbohora/sAUC">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">

<div id="semi-parametric-area-under-the-curve-sauc-regression" class="section level2">
<h2 class="hasAnchor">
<a href="#semi-parametric-area-under-the-curve-sauc-regression" class="anchor"></a>Semi-parametric Area Under the Curve (sAUC) Regression</h2>
<p>Perform AUC analyses with discrete covariates and a semi-parametric estimation</p>
<div id="model" class="section level3">
<h3 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h3>
<p>We consider applications that compare a response variable y between two groups (A and B) while adjusting for k categorical covariates <span class="math inline">\(X_1,X_2,...,X_k\)</span>. The response variable y is a continuous or ordinal variable that is not normally distributed. Without loss of generality, we assume each covariate is coded such that <span class="math inline">\(X_i=1,...,n_i\)</span>,for <span class="math inline">\(i=1,...,k\)</span>. For each combination of the levels of the covariates, we define the Area Under the ROC curve (AUC) in the following way:</p>
<p><span class="math display">\[\pi_{x_1 x_2...x_k}=P(Y^A&gt;Y^B|X_1=x_1,X_2=x_2,...,X_k=x_k )+\frac{1}{2} P(Y^A=Y^B|X_1=x_1,X_2=x_2,...,X_k=x_k ),\]</span></p>
<p>where <span class="math inline">\(x_1=1,...,n_1,...,x_k=1,...,n_k\)</span>, and <span class="math inline">\(Y^A\)</span> and <span class="math inline">\(Y^B\)</span> are two randomly chosen observations from Group A and B, respectively. The second term in the above equation is for the purpose of accounting ties.</p>
<p>For each covariate <span class="math inline">\(X_i\)</span>, without loss of generality, we use the last category as the reference category and define (<span class="math inline">\(n_i-1\)</span>) dummy variables <span class="math inline">\(X_i^{(1)},X_i^{(2)},...,X_i^{(n_i-1)}\)</span> such that</p>
<p><span class="math display">\[X_i^{(j)} (x)= \left\{\begin{array}
{rrr}
1, j = x \\
0, j \ne x,
\end{array}\right.
\]</span></p>
<p>where <span class="math inline">\(i=1,...,k; j=1,...,n_i-1; x=1,...,n_i\)</span>. We model the association between AUC <span class="math inline">\(\pi_{x_1 x_2...x_k}\)</span> and covariates using a logistic model. Such a model specifies that the logit of <span class="math inline">\(\pi_{x_1 x_2...x_k}\)</span> is a linear combination of terms that are products of the dummy variables defined above. Specifically,</p>
<p><span class="math display">\[logit(\pi_{x_1 x_2...x_k } )=Z_{x_1 x_2...x_k} \boldsymbol{\beta},\]</span></p>
<p>where <span class="math inline">\(Z_{x_1 x_2...x_k}\)</span> is a row vector whose elements are zeroes or ones and are products of <span class="math inline">\(X_1^{(1)} (x_1 ),...,X_1^{(n_i-1) } (x_1),...,X_k^{(1)} (x_k),...,X_k^{(n_k-1)} (x_k)\)</span>, and <span class="math inline">\(\boldsymbol{\beta}\)</span> is a column vector of nonrandom unknown parameters. Now, define a column vector <span class="math inline">\(\pi\)</span> by stacking up <span class="math inline">\(\pi_{x_1 x_2...x_k}\)</span> and define a matrix Z by stacking up <span class="math inline">\(Z_{x_1 x_2...x_k}\)</span>, as <span class="math inline">\(x_i\)</span> ranges from 1 to <span class="math inline">\(n_i, i=1,...,k\)</span>, our final model is</p>
<p><span class="math display">\[logit(\pi)=Z\boldsymbol{\beta} ...(1)\]</span></p>
<p>The reason for us to use a logit transformation of the AUC instead of using the original AUC is for variance stabilization. We will illustrate the above general model using examples.</p>
</div>
<div id="estimation" class="section level3">
<h3 class="hasAnchor">
<a href="#estimation" class="anchor"></a>Estimation</h3>
<p>First, we denote the number of observations with covariates <span class="math inline">\(X_1=i_1,...,X_k=i_k\)</span> in groups A and B by <span class="math inline">\(N_{i_1...i_k}^A\)</span> and <span class="math inline">\(N_{i_1...i_k}^B\)</span>, respectively. We assume both <span class="math inline">\(N_{i_1...i_k}^A\)</span> and <span class="math inline">\(N_{i_1...i_k}^B\)</span> are greater than zero in the following development. An unbiased estimator of <span class="math inline">\(\pi_{i_1...i_k}\)</span> proposed by Mann and Whitney (1947) is</p>
<p><span class="math display">\[\hat{\pi}_{i_1...i_k}=\frac{\sum_{l=1}^{N_{i_1...i_k}^A} \sum_{j=1}^{N_{i_1...i_k}^B} I_{lj}}{N_{i_1...i_k}^A N_{i_1...i_k}^B},\]</span></p>
<p>where</p>
<p><span class="math display">\[I_{i_1... i_k; lj}= \left\{\begin{array}
{rrr}
1, Y_{i_1...i_k; l}^A&gt;Y_{i_1...i_k; j}^B \\
\frac{1}{2}, Y_{i_1...i_k; l}^A=Y_{i_1...i_k; j}^B \\
0, Y_{i_1...i_k; l}^A&lt;Y_{i_1...i_k; j}^B
\end{array}\right.
\]</span></p>
<p>and <span class="math inline">\(Y_{i_1...i_k; l}^A\)</span> and <span class="math inline">\(Y_{i_1...i_k; j}^B\)</span> are observations with <span class="math inline">\(X_1=i_1,...,X_k=i_k\)</span> in groups A and B, respectively. Delong, Delong and Clarke-Pearson (1988) have shown that</p>
<p><span class="math display">\[\hat{\pi}_{i_1...i_k} \approx N(\pi_{i_1...i_k},\sigma_{i_1...i_k}^2).\]</span></p>
<p>In order to obtain an estimator for <span class="math inline">\(\sigma_{i_1...i_k}^2\)</span>, they first computed</p>
<p><span class="math display">\[V_{i_1...i_k; l}^A=\frac{1}{N_{i_1...i_k}^B } \sum_{j=1}^{N_{i_1...i_k}^B} I_{lj},    l=1,...,N_{i_1...i_k}^A\]</span></p>
<p>and</p>
<p><span class="math display">\[V_{i_1...i_k;j}^B=\frac{1}{N_{i_1...i_k}^A } \sum_{l=1}^{N_{i_1...i_k}^A} I_{lj},     j=1,...,N_{i_1...i_k}^B\]</span></p>
<p>Then, an estimate of the variance of the nonparametric AUC was</p>
<p><span class="math display">\[\hat{\sigma}_{i_1...i_k}^2=\frac{(s_{i_1...i_k}^A )^2}{N_{i_1...i_k}^A} + \frac{(s_{i_1...i_k}^B )^2}{N_{i_1...i_k}^B},\]</span></p>
<p>where</p>
<p><span class="math inline">\((s_{i_1...i_k}^A )^2\)</span> and <span class="math inline">\((s_{i_1...i_k}^B )^2\)</span> were the sample variances of</p>
<p><span class="math inline">\(V_{i_1...i_k; l}^A; l=1,...,N_{i_1...i_k}^A\)</span> and <span class="math inline">\(V_{i_1...i_k; j}^B; j=1,...,N_{i_1...i_k}^B,\)</span> respectively. Clearly, we need both <span class="math inline">\(N_{i_1...i_k}^A\)</span> and <span class="math inline">\(N_{i_1...i_k}^B\)</span> are greater than two in order to compute <span class="math inline">\(\hat{\sigma}_{i_1...i_k}^2\)</span>.</p>
<p>Now, in order to estimate parameters in Model (1), we first derive the asymptotic variance of <span class="math inline">\(\hat{\gamma}_{i_1...i_k}\)</span> using the delta method, which results in</p>
<p><span class="math display">\[\hat{\gamma}_{i_1...i_k}=logit(\hat{\pi}_{i_1...i_k}) \approx N(logit(\pi_{i_1...i_k}),\tau_{i_1...i_k}^2),\]</span></p>
<p>where <span class="math display">\[\hat{\tau}_{i_1...i_k}^2=\frac{\hat{\gamma}_{i_1...i_k}^2}{\hat{\pi}_{i_1...i_k}^2  (1-\hat{\pi}_{i_1...i_k})^2}\]</span></p>
<p>Rewriting the above model, we obtain</p>
<p><span class="math display">\[\hat{\gamma}_{i_1...i_k}=logit(\pi_{i_1...i_k }) =Z_{i_1...i_k} \boldsymbol{\beta} + \epsilon_{i_1...i_k}\]</span></p>
<p>where,</p>
<p><span class="math inline">\(\epsilon_{i_1,...,i_k} \approx N(0,\tau_{i_1,...,i_k}^2)\)</span>. Then, by stacking up the <span class="math inline">\(\hat{\gamma}_{1_i,...,i_k}\)</span> to be <span class="math inline">\(\hat{\gamma}, Z_{i_1...i_k}\)</span> to be <span class="math inline">\(\boldsymbol{Z}\)</span>, and <span class="math inline">\(\epsilon_{i_1,...,i_k}\)</span> to be <span class="math inline">\(\boldsymbol{\epsilon}\)</span>, we have</p>
<p><span class="math display">\[\boldsymbol{\hat{\gamma}} =logit \boldsymbol{\hat{\pi}} = \boldsymbol{Z\beta + \epsilon},\]</span></p>
<p>where, <span class="math inline">\(E(\epsilon)=0\)</span> and <span class="math inline">\(\hat{T}=Var(\epsilon)=diag(\hat{\tau}_{i_1... i_k}^2)\)</span> which is a diagonal matrix. Finally, by using the generalized least squares method, we estimate the parameters β and its variance-covariance matrix as follows;</p>
<p><span class="math display">\[\boldsymbol{\hat{\beta} ={(\hat{Z}^T  \hat{T}^{-1}  Z)}^{-1} Z^T  \hat{T}^{-1} \hat{\gamma}}\]</span></p>
<p>and <span class="math display">\[\hat{V}(\boldsymbol{\hat{\beta}}) = \boldsymbol{{(\hat{Z}^T  \hat{T}^{-1}  Z)}^{-1}}\]</span></p>
<p>The above equations can be used to construct a 100(1-α)% Wald confidence intervals for <span class="math inline">\(\boldsymbol{\beta_i}\)</span> using formula</p>
<p><span class="math display">\[\hat{\beta}_i \pm Z_{1-\frac{\alpha}{2}} \sqrt{\hat{V}(\hat{\beta}_i)},\]</span></p>
<p>where <span class="math inline">\(Z_{1-\frac{\alpha}{2}}\)</span> is the <span class="math inline">\((1-\frac{\alpha}{2})^{th}\)</span> quantile of the standard normal distribution. Equivalently, we reject</p>
<p><span class="math inline">\(H_0:\beta_i = 0\)</span> if <span class="math inline">\(|\hat{\beta}_i| &gt; Z_{1-\frac{\alpha}{2}} \sqrt{\hat{V}(\hat{\beta}_i)},\)</span></p>
<p>The p-value for testing <span class="math inline">\(H_0\)</span> is <span class="math inline">\(2 * P(Z &gt; |\hat{\beta}_i|/\sqrt{\hat{V}\hat{\beta}_i}),\)</span></p>
<p>where Z is a random variable with the standard normal distribution.</p>
<p>Now, the total number of cells (combinations of covariates <span class="math inline">\(X_1,...,X_k\)</span> is <span class="math inline">\(n_1 n_2...n_k\)</span>. As mentioned earlier, for a cell to be usable in the estimation, the cell needs to have at least two observations from Group A and two observations from Group B. As long as the total number of usable cells is larger than the dimension of <span class="math inline">\(\boldsymbol{\beta}\)</span>, then the matrix <span class="math inline">\({\boldsymbol{\hat{Z}^T \hat{T}^{-1} Z}}\)</span> is invertible and consequently,<span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span> is computable and model (1) is identifiable.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/sbohora/sAUC">https://​github.com/​sbohora/​sAUC</a>
</li>
<li>Report a bug at <br><a href="https://github.com/sbohora/sAUC/issues">https://​github.com/​sbohora/​sAUC/​issues</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Som Bohora <br><small class="roles"> Author, maintainer </small> </li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.com/sbohora/sAUC"><img src="https://travis-ci.com/sbohora/sAUC.svg?token=shyYTzvvbsLRHsRAWXTg" alt="Build Status"></a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Som Bohora.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
